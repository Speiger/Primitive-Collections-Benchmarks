plugins {
  id "me.champeau.gradle.jmh" version "0.5.3"
}

allprojects {
    apply plugin: 'java'
    apply plugin: 'idea'
    apply plugin: 'eclipse'

    group = 'me.champeau.sample'
    version = '1.0-SNAPSHOT'

    sourceCompatibility = 1.8
    targetCompatibility = 1.8

    repositories {
        mavenCentral()
        maven {
        	url = "https://maven.speiger.com/repository/main"
    	}
    }
    dependencies {
    	compile 'de.speiger:Primitive-Collections:0.5.1'
    	compile 'it.unimi.dsi:fastutil:8.5.6'
    	compile 'org.eclipse.collections:eclipse-collections:11.0.0'
	}
}


apply plugin: 'me.champeau.gradle.jmh'

jmh {
    include = ['speiger\\.src\\.collections\\.impl\\.pc\\.*', 'speiger\\.src\\.collections\\.impl\\.fastUtil\\.*', 'speiger\\.src\\.collections\\.impl\\.java\\.*']
    //'speiger\\.src\\.collections\\.*'
    humanOutputFile = null
    resultFormat = 'json'
	resultsFile = file("${buildDir}/reports/jmh/results.json")
    warmupIterations = 1
    iterations = 1
    fork = 2
    operationsPerInvocation = 5
    threads = 2
}

// it is possible to tweak the jmhJar task directly
jmhJar.baseName = 'custom'

subprojects {
    apply plugin: 'me.champeau.gradle.jmh'

    jmh {
    	include = 'speiger\\.src\\.collections\\.Test.*'
        humanOutputFile = null
        warmupIterations = 1
        iterations = 1
    }

}
